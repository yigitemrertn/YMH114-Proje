<!doctype html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ForumFU - Ayarlar</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/settings.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Funnel+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <nav>
        <div class="logo-container">
            <a href="/" class="logo"><h1>ForumFU</h1></a>
        </div>
        <div class="search-container">
            <label for="search-input" class="visually-hidden"></label>
            <input type="text" id="search-input" placeholder="Forumda ara..." class="search-input">
            <button class="search-button">
                <i class="fas fa-search"></i>
            </button>
        </div>
        <div class="nav-controls">
            <button class="search-button-mobile" aria-label="Ara">
                <i class="fas fa-search"></i>
            </button>
            <button class="theme-toggle" aria-label="Toggle Dark Mode">
                <i class="fas fa-moon"></i>
            </button>
            <div class="hamburger-container" id="hamburgerContainer" style="display: block;">
                <button class="hamburger-button" aria-label="Menüyü Aç">
                    <span class="hamburger-icon"></span>
                </button>
                <div class="hamburger-menu">
                    <a href="/" class="menu-item">
                        <i class="fas fa-home"></i>
                        Ana Sayfa
                    </a>
                    <a href="create-post.html" class="menu-item">
                        <i class="fas fa-plus-circle"></i>
                        Konu Oluştur
                    </a>
                    <a href="profile.html" class="menu-item">
                        <i class="fas fa-user"></i>
                        Profil
                    </a>
                    <a href="settings.html" class="menu-item">
                        <i class="fas fa-cog"></i>
                        Ayarlar
                    </a>
                    <a href="logout.php" class="menu-item">
                        <i class="fas fa-sign-out-alt"></i>
                        Çıkış Yap
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="search-dropdown">
        <div class="search-container">
            <label for="search-input-mobile" class="visually-hidden">Forumda ara</label>
            <input type="text" id="search-input-mobile" placeholder="Forumda ara..." class="search-input">
            <button class="search-button">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </div>

    <div class="settings-wrapper">
        <!-- Settings Sidebar -->
        <div class="settings-sidebar">
            <div class="settings-sidebar-header">
                <h1>Ayarlar</h1>
            </div>
            <ul class="settings-nav">
                <li class="settings-nav-item active" data-target="profile-settings">
                    <i class="material-icons">person</i>
                    <span>Profil Ayarları</span>
                </li>
                <li class="settings-nav-item" data-target="privacy-settings">
                    <i class="material-icons">lock</i>
                    <span>Gizlilik Ayarları</span>
                </li>
                <li class="settings-nav-item" data-target="notification-settings">
                    <i class="material-icons">notifications</i>
                    <span>Bildirim Ayarları</span>
                </li>
                <li class="settings-nav-item" data-target="account-settings">
                    <i class="material-icons">manage_accounts</i>
                    <span>Hesap Ayarları</span>
                </li>
                <li class="settings-nav-item" data-target="appearance-settings">
                    <i class="material-icons">palette</i>
                    <span>Görünüm Ayarları</span>
                </li>
            </ul>
        </div>

        <!-- Settings Content -->
        <div class="settings-content">
            <!-- Profile Settings -->
            <div class="settings-section active" id="profile-settings">
                <div class="settings-section-header">
                    <h2>Profil Ayarları</h2>
                </div>
                <form class="settings-form" id="profileSettingsForm" enctype="multipart/form-data">
                    <div class="form-group">
                        <label for="profile-avatar">Profil Resmi</label>
                        <div class="avatar-upload">
                            <div class="avatar-preview">
                                <img id="avatar-preview" src="https://via.placeholder.com/150" alt="Profil Resmi">
                            </div>
                            <div class="avatar-edit">
                                <input type="file" id="profile-avatar" name="avatar" accept=".png, .jpg, .jpeg">
                                <label for="profile-avatar">
                                    <i class="fas fa-camera"></i>
                                    Resim Seç
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="profile-name">Ad Soyad</label>
                        <input type="text" id="profile-name" name="fullName" placeholder="Adınız Soyadınız">
                    </div>
                    <div class="form-group">
                        <label for="profile-username">Kullanıcı Adı</label>
                        <input type="text" id="profile-username" name="username" placeholder="Kullanıcı adınız">
                    </div>
                    <div class="form-group">
                        <label for="profile-email">E-posta</label>
                        <input type="email" id="profile-email" name="email" placeholder="E-posta adresiniz">
                    </div>
                    <div class="form-group">
                        <label for="profile-bio">Hakkımda</label>
                        <textarea id="profile-bio" name="bio" placeholder="Kendinizi tanıtın"></textarea>
                    </div>
                    <button type="submit" class="settings-button">Kaydet</button>
                </form>
            </div>

            <!-- Privacy Settings -->
            <div class="settings-section" id="privacy-settings">
                <div class="settings-section-header">
                    <h2>Gizlilik Ayarları</h2>
                </div>
                <form class="settings-form">
                    <div class="form-group">
                        <h2>Profil Görünürlüğü</h2>
                        <div class="form-group">
                            <input type="radio" id="privacy-public" name="profile-visibility" value="public" checked>
                            <label for="privacy-public">Herkese Açık - Herkes profilinizi görebilir</label>
                        </div>
                        <div class="form-group">
                            <input type="radio" id="privacy-friends" name="profile-visibility" value="friends">
                            <label for="privacy-friends">Sadece Arkadaşlar - Yalnızca takip ettiğiniz kişiler profilinizi görebilir</label>
                        </div>
                        <div class="form-group">
                            <input type="radio" id="privacy-private" name="profile-visibility" value="private">
                            <label for="privacy-private">Gizli - Profiliniz yalnızca size görünür</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="two-factor-auth">İki Faktörlü Doğrulama</label>
                        <div class="toggle-switch">
                            <label for="two-factor-auth">
                                <input type="checkbox" id="two-factor-auth" name="two-factor-auth">
                            </label>
                        </div>
                        <p>Hesabınıza giriş yaparken ek bir güvenlik katmanı ekler</p>
                    </div>
                    <div class="form-group">
                        <label for="show-online-status">Çevrimiçi Durumumu Göster</label>
                        <div class="toggle-switch">
                            <label for="show-online-status">
                                <input type="checkbox" id="show-online-status" name="show-online-status" checked>
                            </label>
                        </div>
                        <p>Diğer kullanıcılar çevrimiçi olduğunuzu görebilir</p>
                    </div>
                    <button type="submit" class="settings-button">Kaydet</button>
                </form>
            </div>

            <!-- Notification Settings -->
            <div class="settings-section" id="notification-settings">
                <div class="settings-section-header">
                    <h2>Bildirim Ayarları</h2>
                </div>
                <form class="settings-form">
                    <div class="form-group">
                        <h2>E-posta Bildirimleri</h2>
                        <div class="toggle-switch">
                            <input type="checkbox" id="email-notifications" name="email-notifications" checked>
                            <label for="email-notifications"></label>
                        </div>
                        <p>Önemli güncellemeler ve etkinlikler hakkında e-posta alın</p>
                    </div>
                    <div class="form-group">
                        <h2>Yeni Mesaj Bildirimleri</h2>
                        <div class="toggle-switch">
                            <label for="message-notifications">
                                <input type="checkbox" id="message-notifications" name="message-notifications" checked>
                            </label>
                        </div>
                        <p>Yeni mesaj aldığınızda bildirim alın</p>
                    </div>
                    <div class="form-group">
                        <label for="comment-notifications">Yorum Bildirimleri</label>
                        <div class="toggle-switch">
                            <label for="comment-notifications">
                                <input type="checkbox" id="comment-notifications" name="comment-notifications" checked>
                            </label>
                        </div>
                        <p>Gönderilerinize yorum yapıldığında bildirim alın</p>
                    </div>
                    <div class="form-group">
                        <label for="follower-notifications">Takipçi Bildirimleri</label>
                        <div class="toggle-switch">
                            <label for="follower-notifications">
                                <input type="checkbox" id="follower-notifications" name="follower-notifications" checked>
                            </label>
                        </div>
                        <p>Biri sizi takip etmeye başladığında bildirim alın</p>
                    </div>
                    <button type="submit" class="settings-button">Kaydet</button>
                </form>
            </div>

            <!-- Account Settings -->
            <div class="settings-section" id="account-settings">
                <div class="settings-section-header">
                    <h2>Hesap Ayarları</h2>
                </div>
                <form class="settings-form">
                    <div class="form-group">
                        <label for="current-password">Mevcut Şifre</label>
                        <input type="password" id="current-password" name="current-password" placeholder="Mevcut şifreniz">
                    </div>
                    <div class="form-group">
                        <label for="new-password">Yeni Şifre</label>
                        <input type="password" id="new-password" name="new-password" placeholder="Yeni şifreniz">
                        <div class="password-strength">
                            <div class="strength-bar"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="confirm-password">Şifre Tekrar</label>
                        <input type="password" id="confirm-password" name="confirm-password" placeholder="Yeni şifrenizi tekrar girin">
                    </div>
                    <button type="submit" class="settings-button">Şifreyi Güncelle</button>

                    <div class="danger-zone">
                        <h3>Tehlikeli Bölge</h3>
                        <p>Bu işlemler geri alınamaz ve hesabınızı kalıcı olarak etkileyebilir.</p>
                        <div style="margin-top: 15px;">
                            <button type="button" class="danger-button" id="deactivate-account">Hesabı Devre Dışı Bırak</button>
                            <button type="button" class="danger-button" id="delete-account">Hesabı Sil</button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Appearance Settings -->
            <div class="settings-section" id="appearance-settings">
                <div class="settings-section-header">
                    <h2>Görünüm Ayarları</h2>
                </div>
                <form class="settings-form">
                    <div class="form-group">
                        <h2>Tema</h2>
                        <div class="form-group">
                            <input type="radio" id="theme-light" name="theme" value="light" checked>
                            <label for="theme-light">Açık Tema - Beyaz arka plan ve koyu metin</label>
                        </div>
                        <div class="form-group">
                            <input type="radio" id="theme-dark" name="theme" value="dark">
                            <label for="theme-dark">Koyu Tema - Koyu arka plan ve açık metin</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="font-size">Yazı Boyutu</label>
                        <input type="range" id="font-size" name="font-size" min="12" max="20" value="16">
                        <div class="range-value">16px</div>
                    </div>
                    <button type="submit" class="settings-button">Kaydet</button>
                </form>
            </div>
        </div>
    </div>
    <script src="js/settings.js"></script>
    <script src="js/search.js"></script>
    <script src="js/login.js"></script>
    <script src="js/avatar.js"></script>
    <script src="js/theme-toggle.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Avatar yükleme işlemi
            const avatarInput = document.getElementById('profile-avatar');
            const avatarPreview = document.getElementById('avatar-preview');

            avatarInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        avatarPreview.src = e.target.result;
                        // Avatar yüklendiğinde localStorage'a kaydet
                        localStorage.setItem('customAvatar', e.target.result);
                    }
                    reader.readAsDataURL(file);
                }
            });

            // Sayfa yüklendiğinde avatar kontrolü
            const customAvatar = localStorage.getItem('customAvatar');
            if (customAvatar) {
                avatarPreview.src = customAvatar;
            } else {
                // Default avatar kullan
                const username = localStorage.getItem('username');
                setDefaultAvatar(username);
            }

            // Sayfa yüklendiğinde çıkış butonunu ayarla
            setupLogoutButton();
        });

        // Çıkış yapma butonunu ayarla
        function setupLogoutButton() {
            const logoutButton = document.querySelector('a[href="logout.php"]');
            if (logoutButton) {
                logoutButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    fetch('../logout.php')
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                window.location.href = '../index.html';
                            } else {
                                console.error('Çıkış yapılamadı');
                            }
                        })
                        .catch(error => {
                            console.error('Çıkış yapılırken hata oluştu:', error);
                        });
                });
            }
        }

        document.getElementById('profileSettingsForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const form = e.target;
    const formData = new FormData(form);
    fetch('api/user/update-profile.php', {
        method: 'POST',
        body: formData
    })
    .then(res => res.json())
    .then(data => {
        alert(data.message);
        if (data.success) {
            location.reload();
        }
    });
});
    </script>
    <script src="js/hamburger.js"></script>
</body>
</html>
